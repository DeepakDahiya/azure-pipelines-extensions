{
   "manifestVersion":1,
   "id":"GoogleOptimize",
   "version":"1.0.0",
   "publisher":"ms-devlabs",
   "name":"Google Optimize",
   "description":"Google Optimize extension for Azure Pipelines.",
   "public":false,
   "icons":{
      "default":"Tasks/GoogleOptimize/icon.png"
   },
   "categories":[
      "Azure Pipelines"
   ],
   "tags":[
      "Build",
      "Release"
   ],
   "branding":{
      "color":"rgb(51,65,133)",
      "theme":"dark"
   },
   "targets":[
      {
         "id":"Microsoft.VisualStudio.Services.Cloud"
      },
      {
         "id":"Microsoft.TeamFoundation.Server",
         "version":"[15.3,)"
      }
   ],
   "contributions":[
      {
         "id":"optimizely-endpoint-type",
         "description":"i18n: Service Connection for Google Optimize",
         "type":"ms.vss-endpoint.service-endpoint-type",
         "targets":[
            "ms.vss-endpoint.endpoint-types"
         ],
         "properties":{
            "name":"googleoptimize",
            "displayName":"Google Optimize",
            "url":"https://www.googleapis.com/analytics/v3",
            "authenticationSchemes":[
               {
                  "type":"ms.vss-endpoint.endpoint-auth-scheme-JWT"
               }
            ],
            "dataSources":[
               {
                  "name":"experimentList",
                  "endpointUrl":"{{endpoint.url}}/management/accounts/{{accountId}}/webproperties/{{webPropertyId}}/profiles/{{profileId}}/experiments",
                  "resultSelector":"jsonpath:$.items[*]"
               },
               {
                  "name":"fetchAccountId",
                  "endpointUrl":"{{endpoint.url}}/management/accounts",
                  "resultSelector":"jsonpath:$.items[*]"
               },
               {
                  "name":"fetchWebPropertyId",
                  "endpointUrl":"{{endpoint.url}}/management/accounts/{{accountId}}/webproperties",
                  "resultSelector":"jsonpath:$.items[*]"
               },
               {
                  "name":"fetchProfileId",
                  "endpointUrl":"{{endpoint.url}}/management/accounts/{{accountId}}/webproperties/{{webPropertyId}}/profiles",
                  "resultSelector":"jsonpath:$.items[*]"
              },
              {
                 "name":"fetchExperiment",
                 "endpointUrl":"{{endpoint.url}}/management/accounts/{{accountId}}/webproperties/{{webPropertyId}}/profiles/{{profileId}}/experiments/{{experimentId}}",
                 "resultSelector":"jsonpath:$.items[*]"
             },
             {
                "name":"fetchData",
                "endpointUrl":"{{endpoint.url}}/data/ga?ids={{ids}}&start-date={{startDate}}&end-date={{endDate}}&metrics={{metrics}}&dimensions={{dimensions}}",
                "resultSelector":"jsonpath:$.rows[*]"
             }
            ]
         }
      },
      {
         "id":"optimize-task",
         "type":"ms.vss-distributed-task.task",
         "targets":[
            "ms.vss-distributed-task.tasks"
         ],
         "properties":{
            "name":"Tasks/GoogleOptimize"
         }
      }
   ],
   "files":[
      {
         "path":"Tasks/GoogleOptimize",
         "addressable":false
      }
   ],
   "scopes":[
      "vso.build",
      "vso.release",
      "vso.serviceendpoint",
      "vso.serviceendpoint_query"
   ]
}
